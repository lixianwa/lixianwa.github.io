<!doctype html><html lang=zh><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="ie=edge"><title>Go语言SOLID实践系列一之单一职责原则 | Lionel's Blog</title><link href=/favicon.ico rel="shortcut icon" type=image/x-icon><meta name=author content="归零"><meta name=description content="什么是SOLID? 以下引用wikipedia上的解释：
 SOLID指面向对象编程和面向对象设计的五个基本原则。当这些原则被一起应用时，它们使得一个程序员开发一个容易进行软件维护和扩展的系统变得更加可能。SOLID所包含的原则是通过引发编程者进行软件源代码的代码重构进行软件的代码异味清扫，从而使得软件清晰可读以及可扩展时可以应用的指南。SOLID被典型的应用在测试驱动开发上，并且是敏捷开发以及自适应软件开发的基本原则的重要组成部分
"><meta name=generator content="Hugo 0.81.0"><link rel=canonical href=https://lixianwa.github.io/posts/go%E8%AF%AD%E8%A8%80solid%E5%AE%9E%E8%B7%B5%E7%B3%BB%E5%88%97%E4%B8%80%E4%B9%8B%E5%8D%95%E4%B8%80%E8%81%8C%E8%B4%A3%E5%8E%9F%E5%88%99/><meta property="og:title" content="Go语言SOLID实践系列一之单一职责原则"><meta property="og:description" content="什么是SOLID?
以下引用wikipedia上的解释：

SOLID指面向对象编程和面向对象设计的五个基本原则。当这些原则被一起应用时，它们使得一个程序员开发一个容易进行软件维护和扩展的系统变得更加可能。SOLID所包含的原则是通过引发编程者进行软件源代码的代码重构进行软件的代码异味清扫，从而使得软件清晰可读以及可扩展时可以应用的指南。SOLID被典型的应用在测试驱动开发上，并且是敏捷开发以及自适应软件开发的基本原则的重要组成部分
"><meta property="og:type" content="article"><meta property="og:url" content="https://lixianwa.github.io/posts/go%E8%AF%AD%E8%A8%80solid%E5%AE%9E%E8%B7%B5%E7%B3%BB%E5%88%97%E4%B8%80%E4%B9%8B%E5%8D%95%E4%B8%80%E8%81%8C%E8%B4%A3%E5%8E%9F%E5%88%99/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2021-12-23T11:17:05+08:00"><meta property="article:modified_time" content="2021-12-23T11:17:05+08:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Go语言SOLID实践系列一之单一职责原则"><meta name=twitter:description content="什么是SOLID?
以下引用wikipedia上的解释：

SOLID指面向对象编程和面向对象设计的五个基本原则。当这些原则被一起应用时，它们使得一个程序员开发一个容易进行软件维护和扩展的系统变得更加可能。SOLID所包含的原则是通过引发编程者进行软件源代码的代码重构进行软件的代码异味清扫，从而使得软件清晰可读以及可扩展时可以应用的指南。SOLID被典型的应用在测试驱动开发上，并且是敏捷开发以及自适应软件开发的基本原则的重要组成部分
"><link rel=stylesheet href=/css/semantic.min.css><link rel=stylesheet href=/css/icomoon.css><link rel=stylesheet href=/css/OverlayScrollbars.min.css><link rel=stylesheet href=/css/github-markdown.css><link rel=stylesheet href=/css/site.css><style>a:not(.ui.button):hover{text-decoration:underline}a:not(.ui.button){color:#2e8b57!important}.inverted a:not(.ui.button),.inverted a:not(.ui.button):hover{color:#8fbc8f!important}body.default{background-color:#f7f7f7;background-image:url(/me/background.jpeg)}body.dark{background-color:#000}</style><link rel=stylesheet data-highlight href=https://cdn.jsdelivr.net/gh/highlightjs/cdn-release/build/styles/gruvbox-light.min.css><link rel=stylesheet href=/css/custom.css></head><body class=default><nav class="ui secondary menu dream-menu"><div class=item><i class="large link bullseye icon dream-flip-toggle" title=翻转！></i></div><div class=item><i class="large link home icon" title=首页 onclick="window.location.href='https://lixianwa.github.io/'"></i></div><div class=item><i class="large link icon theme-switch" onclick=themeSwitch()></i></div><div class=item><i class="large link search icon" onclick=toggleSearch()></i></div></nav><div class=flip-container><div class=flipper><section class=front><div class=dream-max-width><div class="ui relaxed grid dream-grid dream-grid-single"><aside class="sixteen wide mobile sixteen wide tablet four wide computer column dream-single-aside"><div class="ui segment toc"><nav id=TableOfContents><ul><li><a href=#什么是solid>什么是<code>SOLID</code>?</a></li><li><a href=#单一职责原则实践>单一职责原则实践</a><ul><li><a href=#不符合单一职责原则时>不符合单一职责原则时</a></li><li><a href=#如何做到符合单职责原则>如何做到符合单职责原则</a></li><li><a href=#其他实践>其他实践</a></li></ul></li><li><a href=#总结>总结</a></li></ul></nav></div><div class="ui segment actions"><button class="ui circular icon button save-as-image" title=保存为图片 onclick=savePostAsImg()>
<i class="save icon"></i></button>
<a href="https://twitter.com/intent/tweet?text=Go%e8%af%ad%e8%a8%80SOLID%e5%ae%9e%e8%b7%b5%e7%b3%bb%e5%88%97%e4%b8%80%e4%b9%8b%e5%8d%95%e4%b8%80%e8%81%8c%e8%b4%a3%e5%8e%9f%e5%88%99&url=https%3a%2f%2flixianwa.github.io%2fposts%2fgo%25E8%25AF%25AD%25E8%25A8%2580solid%25E5%25AE%259E%25E8%25B7%25B5%25E7%25B3%25BB%25E5%2588%2597%25E4%25B8%2580%25E4%25B9%258B%25E5%258D%2595%25E4%25B8%2580%25E8%2581%258C%25E8%25B4%25A3%25E5%258E%259F%25E5%2588%2599%2f" class="ui circular twitter icon button"><i class="twitter icon"></i></a><a href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2flixianwa.github.io%2fposts%2fgo%25E8%25AF%25AD%25E8%25A8%2580solid%25E5%25AE%259E%25E8%25B7%25B5%25E7%25B3%25BB%25E5%2588%2597%25E4%25B8%2580%25E4%25B9%258B%25E5%258D%2595%25E4%25B8%2580%25E8%2581%258C%25E8%25B4%25A3%25E5%258E%259F%25E5%2588%2599%2f" class="ui circular facebook icon button"><i class="facebook icon"></i></a></div></aside><div class="sixteen wide mobile sixteen wide tablet twelve wide computer column markdown-body dream-single" id=dream-save-post-as-img><section class="ui attached segment"><header><h1 class="ui large header">Go语言SOLID实践系列一之单一职责原则<div class="sub header">@
归零
|
星期四，十二月 23 日，2021 年
| 3 分钟阅读
| 更新于
星期四，十二月 23 日，2021 年</div></h1></header><article class=main><h2 id=什么是solid>什么是<code>SOLID</code>?</h2><p>以下引用wikipedia上的解释：</p><blockquote><p><code>SOLID</code>指面向对象编程和面向对象设计的五个基本原则。当这些原则被一起应用时，它们使得一个程序员开发一个容易进行软件维护和扩展的系统变得更加可能。<code>SOLID</code>所包含的原则是通过引发编程者进行软件源代码的代码重构进行软件的代码异味清扫，从而使得软件清晰可读以及可扩展时可以应用的指南。<code>SOLID</code>被典型的应用在测试驱动开发上，并且是敏捷开发以及自适应软件开发的基本原则的重要组成部分</p></blockquote><table><thead><tr><th>首字母</th><th>指代</th><th>概念</th></tr></thead><tbody><tr><td>S</td><td>单一功能原则</td><td>认为“对象应该仅具有一种单一功能”的概念</td></tr><tr><td>O</td><td>开闭原则</td><td>认为“软件应该是对于扩展开放的，但是对于修改封闭的”的概念。</td></tr><tr><td>L</td><td>里氏替换原则</td><td>认为“程序中的对象应该是可以在不改变程序正确性的前提下被它的子类所替换的”的概念。</td></tr><tr><td>I</td><td>接口隔离原则</td><td>认为“多个特定客户端接口要好于一个宽泛用途的接口” 的概念。</td></tr><tr><td>D</td><td>依赖反转原则</td><td>认为一个方法应该遵从“依赖于抽象而不是一个实例”的概念，依赖注入是该原则的一种实现方式。</td></tr></tbody></table><p>这些原则是Bob大叔第一次在文章中提出。后来在他的书<a href=https://www.amazon.com/dp/935286512X>《Clean Architecture》</a>中塑造了这些原则。</p><p>在这篇文章中，我打算通过围棋的例子来开始我对所有SOLID原则的实践列表中的第一个SOLID原则-单一责任原则，也就是SOLID这个词中的字母S所代表的原则。</p><h2 id=单一职责原则实践>单一职责原则实践</h2><h3 id=不符合单一职责原则时>不符合单一职责原则时</h3><p>单一责任原则（SRP，以下都简称SRP）指出，每个软件模块应该有且仅有一个存在的理由。</p><p>上面这句话是Bob大叔自己写的。它的意思是最初绑定在一个模块上，通过映射到组织的日常工作来划分职责。</p><p>如今，SRP的范围很广，它触及软件的不同方面。我们可以在类、函数、模块中使用。当然，在Go中我们可以在struct中使用。</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-Go data-lang=Go><span style=color:#66d9ef>type</span> <span style=color:#a6e22e>EmailService</span> <span style=color:#66d9ef>struct</span> {
   <span style=color:#a6e22e>db</span>           <span style=color:#f92672>*</span><span style=color:#a6e22e>gorm</span>.<span style=color:#a6e22e>DB</span>
   <span style=color:#a6e22e>smtpHost</span>     <span style=color:#66d9ef>string</span>
   <span style=color:#a6e22e>smtpPassword</span> <span style=color:#66d9ef>string</span>
   <span style=color:#a6e22e>smtpPort</span>     <span style=color:#66d9ef>int</span>
}

<span style=color:#66d9ef>func</span> <span style=color:#a6e22e>NewEmailService</span>(<span style=color:#a6e22e>db</span> <span style=color:#f92672>*</span><span style=color:#a6e22e>gorm</span>.<span style=color:#a6e22e>DB</span>, <span style=color:#a6e22e>smtpHost</span> <span style=color:#66d9ef>string</span>, <span style=color:#a6e22e>smtpPassword</span> <span style=color:#66d9ef>string</span>, <span style=color:#a6e22e>smtpPort</span> <span style=color:#66d9ef>int</span>) <span style=color:#f92672>*</span><span style=color:#a6e22e>EmailService</span> {
   <span style=color:#66d9ef>return</span> <span style=color:#f92672>&amp;</span><span style=color:#a6e22e>EmailService</span>{
       <span style=color:#a6e22e>db</span>:           <span style=color:#a6e22e>db</span>,
       <span style=color:#a6e22e>smtpHost</span>:     <span style=color:#a6e22e>smtpHost</span>,
       <span style=color:#a6e22e>smtpPassword</span>: <span style=color:#a6e22e>smtpPassword</span>,
       <span style=color:#a6e22e>smtpPort</span>:     <span style=color:#a6e22e>smtpPort</span>,
   }
}

<span style=color:#66d9ef>func</span> (<span style=color:#a6e22e>s</span> <span style=color:#f92672>*</span><span style=color:#a6e22e>EmailService</span>) <span style=color:#a6e22e>Send</span>(<span style=color:#a6e22e>from</span> <span style=color:#66d9ef>string</span>, <span style=color:#a6e22e>to</span> <span style=color:#66d9ef>string</span>, <span style=color:#a6e22e>subject</span> <span style=color:#66d9ef>string</span>, <span style=color:#a6e22e>message</span> <span style=color:#66d9ef>string</span>) <span style=color:#66d9ef>error</span> {
   <span style=color:#a6e22e>email</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>EmailGorm</span>{
       <span style=color:#a6e22e>From</span>:    <span style=color:#a6e22e>from</span>,
       <span style=color:#a6e22e>To</span>:      <span style=color:#a6e22e>to</span>,
       <span style=color:#a6e22e>Subject</span>: <span style=color:#a6e22e>subject</span>,
       <span style=color:#a6e22e>Message</span>: <span style=color:#a6e22e>message</span>,
   }

   <span style=color:#a6e22e>err</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>s</span>.<span style=color:#a6e22e>db</span>.<span style=color:#a6e22e>Create</span>(<span style=color:#f92672>&amp;</span><span style=color:#a6e22e>email</span>).<span style=color:#a6e22e>Error</span>
   <span style=color:#66d9ef>if</span> <span style=color:#a6e22e>err</span> <span style=color:#f92672>!=</span> <span style=color:#66d9ef>nil</span> {
       <span style=color:#a6e22e>log</span>.<span style=color:#a6e22e>Println</span>(<span style=color:#a6e22e>err</span>)
       <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>err</span>
   }
   
   <span style=color:#a6e22e>auth</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>smtp</span>.<span style=color:#a6e22e>PlainAuth</span>(<span style=color:#e6db74>&#34;&#34;</span>, <span style=color:#a6e22e>from</span>, <span style=color:#a6e22e>s</span>.<span style=color:#a6e22e>smtpPassword</span>, <span style=color:#a6e22e>s</span>.<span style=color:#a6e22e>smtpHost</span>)
   
   <span style=color:#a6e22e>server</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Sprintf</span>(<span style=color:#e6db74>&#34;%s:%d&#34;</span>, <span style=color:#a6e22e>s</span>.<span style=color:#a6e22e>smtpHost</span>, <span style=color:#a6e22e>s</span>.<span style=color:#a6e22e>smtpPort</span>)
   
   <span style=color:#a6e22e>err</span> = <span style=color:#a6e22e>smtp</span>.<span style=color:#a6e22e>SendMail</span>(<span style=color:#a6e22e>server</span>, <span style=color:#a6e22e>auth</span>, <span style=color:#a6e22e>from</span>, []<span style=color:#66d9ef>string</span>{<span style=color:#a6e22e>to</span>}, []byte(<span style=color:#a6e22e>message</span>))
   <span style=color:#66d9ef>if</span> <span style=color:#a6e22e>err</span> <span style=color:#f92672>!=</span> <span style=color:#66d9ef>nil</span> {
       <span style=color:#a6e22e>log</span>.<span style=color:#a6e22e>Println</span>(<span style=color:#a6e22e>err</span>)
       <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>err</span>
   }

   <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>nil</span>
}
</code></pre></div><p>在上面的代码块。我们有一个struct类型的EmailService，其中包含一个方法Send。我们使用这个服务来发送邮件。即使运行起来没有问题，但我们意识到，当我们从表面上看时，这段代码破坏了SRP。</p><p>EmailService的职责不仅仅是发送邮件，而是将邮件存储到DB<code>和</code>通过SMTP协议发送。
仔细看一下上面的句子。&ldquo;和"字是粗体的，是有目的的。使用这样的表达方式看起来并不像我们描述单一责任的情况。
只要描述某些代码结构的职责时需要使用 &ldquo;和 &ldquo;字，就已经破坏了单一职责原则。</p><p>在上面的例子中，在代码层面我们在很多方面破坏了SRP。</p><ul><li>在函数层面上。函数Send既负责在数据库中存储消息，又负责通过SMTP协议发送邮件。</li><li>结构体EmailService，它也有两个职责，在数据库内存储和发送邮件。</li></ul><p>这样的代码有什么后果呢？</p><ul><li>当我们改变表结构或存储类型时，我们需要改变通过SMTP发送邮件的代码。</li><li>当我们想集成Mailgun或Mailjet等发送邮件的方式时，我们需要改变在MySQL数据库中存储数据的代码。</li><li>如果我们在应用程序中选择不同的发送邮件的方式，每个方式都需要有一个逻辑来存储数据库中的数据。</li></ul><p>假设我们决定将应用程序的责任分成两个，一个负责维护数据库，另一个负责整合电子邮件供应商。在这种情况下，他们将在同一个代码断上工作。</p><p>这种代码实现实际上是无法用单元测试来测试的。</p><p>所以，让我们重构这段代码。</p><h3 id=如何做到符合单职责原则>如何做到符合单职责原则</h3><p>在这种情况下，为了分清职责，使代码块只有一个存在的理由，我们应该为它们分别定义一个结构体å。</p><p>这实际上意味着有一个单独的结构体用于将数据存储在某些存储器中，另一个不同的结构体用于通过与电子邮件提供商的集成来发送电子邮件。如下：</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-Go data-lang=Go><span style=color:#66d9ef>type</span> <span style=color:#a6e22e>EmailGorm</span> <span style=color:#66d9ef>struct</span> {
	<span style=color:#a6e22e>gorm</span>.<span style=color:#a6e22e>Model</span>
	<span style=color:#a6e22e>From</span>    <span style=color:#66d9ef>string</span>
	<span style=color:#a6e22e>To</span>      <span style=color:#66d9ef>string</span>
	<span style=color:#a6e22e>Subject</span> <span style=color:#66d9ef>string</span>
	<span style=color:#a6e22e>Message</span> <span style=color:#66d9ef>string</span>
}

<span style=color:#66d9ef>type</span> <span style=color:#a6e22e>EmailRepository</span> <span style=color:#66d9ef>interface</span> {
	<span style=color:#a6e22e>Save</span>(<span style=color:#a6e22e>from</span> <span style=color:#66d9ef>string</span>, <span style=color:#a6e22e>to</span> <span style=color:#66d9ef>string</span>, <span style=color:#a6e22e>subject</span> <span style=color:#66d9ef>string</span>, <span style=color:#a6e22e>message</span> <span style=color:#66d9ef>string</span>) <span style=color:#66d9ef>error</span>
}

<span style=color:#66d9ef>type</span> <span style=color:#a6e22e>EmailDBRepository</span> <span style=color:#66d9ef>struct</span> {
	<span style=color:#a6e22e>db</span> <span style=color:#f92672>*</span><span style=color:#a6e22e>gorm</span>.<span style=color:#a6e22e>DB</span>
}

<span style=color:#66d9ef>func</span> <span style=color:#a6e22e>NewEmailRepository</span>(<span style=color:#a6e22e>db</span> <span style=color:#f92672>*</span><span style=color:#a6e22e>gorm</span>.<span style=color:#a6e22e>DB</span>) <span style=color:#a6e22e>EmailRepository</span> {
	<span style=color:#66d9ef>return</span> <span style=color:#f92672>&amp;</span><span style=color:#a6e22e>EmailDBRepository</span>{
		<span style=color:#a6e22e>db</span>: <span style=color:#a6e22e>db</span>,
	}
}

<span style=color:#66d9ef>func</span> (<span style=color:#a6e22e>r</span> <span style=color:#f92672>*</span><span style=color:#a6e22e>EmailDBRepository</span>) <span style=color:#a6e22e>Save</span>(<span style=color:#a6e22e>from</span> <span style=color:#66d9ef>string</span>, <span style=color:#a6e22e>to</span> <span style=color:#66d9ef>string</span>, <span style=color:#a6e22e>subject</span> <span style=color:#66d9ef>string</span>, <span style=color:#a6e22e>message</span> <span style=color:#66d9ef>string</span>) <span style=color:#66d9ef>error</span> {
	<span style=color:#a6e22e>email</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>EmailGorm</span>{
		<span style=color:#a6e22e>From</span>:    <span style=color:#a6e22e>from</span>,
		<span style=color:#a6e22e>To</span>:      <span style=color:#a6e22e>to</span>,
		<span style=color:#a6e22e>Subject</span>: <span style=color:#a6e22e>subject</span>,
		<span style=color:#a6e22e>Message</span>: <span style=color:#a6e22e>message</span>,
	}

	<span style=color:#a6e22e>err</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>r</span>.<span style=color:#a6e22e>db</span>.<span style=color:#a6e22e>Create</span>(<span style=color:#f92672>&amp;</span><span style=color:#a6e22e>email</span>).<span style=color:#a6e22e>Error</span>
	<span style=color:#66d9ef>if</span> <span style=color:#a6e22e>err</span> <span style=color:#f92672>!=</span> <span style=color:#66d9ef>nil</span> {
		<span style=color:#a6e22e>log</span>.<span style=color:#a6e22e>Println</span>(<span style=color:#a6e22e>err</span>)
		<span style=color:#66d9ef>return</span> <span style=color:#a6e22e>err</span>
	}

	<span style=color:#66d9ef>return</span> <span style=color:#66d9ef>nil</span>
}

<span style=color:#66d9ef>type</span> <span style=color:#a6e22e>EmailSender</span> <span style=color:#66d9ef>interface</span> {
	<span style=color:#a6e22e>Send</span>(<span style=color:#a6e22e>from</span> <span style=color:#66d9ef>string</span>, <span style=color:#a6e22e>to</span> <span style=color:#66d9ef>string</span>, <span style=color:#a6e22e>subject</span> <span style=color:#66d9ef>string</span>, <span style=color:#a6e22e>message</span> <span style=color:#66d9ef>string</span>) <span style=color:#66d9ef>error</span>
}

<span style=color:#66d9ef>type</span> <span style=color:#a6e22e>EmailSMTPSender</span> <span style=color:#66d9ef>struct</span> {
	<span style=color:#a6e22e>smtpHost</span>     <span style=color:#66d9ef>string</span>
	<span style=color:#a6e22e>smtpPassword</span> <span style=color:#66d9ef>string</span>
	<span style=color:#a6e22e>smtpPort</span>     <span style=color:#66d9ef>int</span>
}

<span style=color:#66d9ef>func</span> <span style=color:#a6e22e>NewEmailSender</span>(<span style=color:#a6e22e>smtpHost</span> <span style=color:#66d9ef>string</span>, <span style=color:#a6e22e>smtpPassword</span> <span style=color:#66d9ef>string</span>, <span style=color:#a6e22e>smtpPort</span> <span style=color:#66d9ef>int</span>) <span style=color:#a6e22e>EmailSender</span> {
	<span style=color:#66d9ef>return</span> <span style=color:#f92672>&amp;</span><span style=color:#a6e22e>EmailSMTPSender</span>{
		<span style=color:#a6e22e>smtpHost</span>:     <span style=color:#a6e22e>smtpHost</span>,
		<span style=color:#a6e22e>smtpPassword</span>: <span style=color:#a6e22e>smtpPassword</span>,
		<span style=color:#a6e22e>smtpPort</span>:     <span style=color:#a6e22e>smtpPort</span>,
	}
}

<span style=color:#66d9ef>func</span> (<span style=color:#a6e22e>s</span> <span style=color:#f92672>*</span><span style=color:#a6e22e>EmailSMTPSender</span>) <span style=color:#a6e22e>Send</span>(<span style=color:#a6e22e>from</span> <span style=color:#66d9ef>string</span>, <span style=color:#a6e22e>to</span> <span style=color:#66d9ef>string</span>, <span style=color:#a6e22e>subject</span> <span style=color:#66d9ef>string</span>, <span style=color:#a6e22e>message</span> <span style=color:#66d9ef>string</span>) <span style=color:#66d9ef>error</span> {
	<span style=color:#a6e22e>auth</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>smtp</span>.<span style=color:#a6e22e>PlainAuth</span>(<span style=color:#e6db74>&#34;&#34;</span>, <span style=color:#a6e22e>from</span>, <span style=color:#a6e22e>s</span>.<span style=color:#a6e22e>smtpPassword</span>, <span style=color:#a6e22e>s</span>.<span style=color:#a6e22e>smtpHost</span>)

	<span style=color:#a6e22e>server</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Sprintf</span>(<span style=color:#e6db74>&#34;%s:%d&#34;</span>, <span style=color:#a6e22e>s</span>.<span style=color:#a6e22e>smtpHost</span>, <span style=color:#a6e22e>s</span>.<span style=color:#a6e22e>smtpPort</span>)

	<span style=color:#a6e22e>err</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>smtp</span>.<span style=color:#a6e22e>SendMail</span>(<span style=color:#a6e22e>server</span>, <span style=color:#a6e22e>auth</span>, <span style=color:#a6e22e>from</span>, []<span style=color:#66d9ef>string</span>{<span style=color:#a6e22e>to</span>}, []byte(<span style=color:#a6e22e>message</span>))
	<span style=color:#66d9ef>if</span> <span style=color:#a6e22e>err</span> <span style=color:#f92672>!=</span> <span style=color:#66d9ef>nil</span> {
		<span style=color:#a6e22e>log</span>.<span style=color:#a6e22e>Println</span>(<span style=color:#a6e22e>err</span>)
		<span style=color:#66d9ef>return</span> <span style=color:#a6e22e>err</span>
	}

	<span style=color:#66d9ef>return</span> <span style=color:#66d9ef>nil</span>
}

<span style=color:#66d9ef>type</span> <span style=color:#a6e22e>EmailService</span> <span style=color:#66d9ef>struct</span> {
	<span style=color:#a6e22e>repository</span> <span style=color:#a6e22e>EmailRepository</span>
	<span style=color:#a6e22e>sender</span>     <span style=color:#a6e22e>EmailSender</span>
}

<span style=color:#66d9ef>func</span> <span style=color:#a6e22e>NewEmailService</span>(<span style=color:#a6e22e>repository</span> <span style=color:#a6e22e>EmailRepository</span>, <span style=color:#a6e22e>sender</span> <span style=color:#a6e22e>EmailSender</span>) <span style=color:#f92672>*</span><span style=color:#a6e22e>EmailService</span> {
	<span style=color:#66d9ef>return</span> <span style=color:#f92672>&amp;</span><span style=color:#a6e22e>EmailService</span>{
		<span style=color:#a6e22e>repository</span>: <span style=color:#a6e22e>repository</span>,
		<span style=color:#a6e22e>sender</span>:     <span style=color:#a6e22e>sender</span>,
	}
}

<span style=color:#66d9ef>func</span> (<span style=color:#a6e22e>s</span> <span style=color:#f92672>*</span><span style=color:#a6e22e>EmailService</span>) <span style=color:#a6e22e>Send</span>(<span style=color:#a6e22e>from</span> <span style=color:#66d9ef>string</span>, <span style=color:#a6e22e>to</span> <span style=color:#66d9ef>string</span>, <span style=color:#a6e22e>subject</span> <span style=color:#66d9ef>string</span>, <span style=color:#a6e22e>message</span> <span style=color:#66d9ef>string</span>) <span style=color:#66d9ef>error</span> {
	<span style=color:#a6e22e>err</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>s</span>.<span style=color:#a6e22e>repository</span>.<span style=color:#a6e22e>Save</span>(<span style=color:#a6e22e>from</span>, <span style=color:#a6e22e>to</span>, <span style=color:#a6e22e>subject</span>, <span style=color:#a6e22e>message</span>)
	<span style=color:#66d9ef>if</span> <span style=color:#a6e22e>err</span> <span style=color:#f92672>!=</span> <span style=color:#66d9ef>nil</span> {
		<span style=color:#66d9ef>return</span> <span style=color:#a6e22e>err</span>
	}

	<span style=color:#66d9ef>return</span> <span style=color:#a6e22e>s</span>.<span style=color:#a6e22e>sender</span>.<span style=color:#a6e22e>Send</span>(<span style=color:#a6e22e>from</span>, <span style=color:#a6e22e>to</span>, <span style=color:#a6e22e>subject</span>, <span style=color:#a6e22e>message</span>)
}
</code></pre></div><p>这里我们提供了两个新的结构体。一个是EmailDBRepository，作为EmailRepository接口的一个实现。它包括对底层数据库中数据持久化的实现。</p><p>第二个结构体是EmailSMTPSender，实现了EmailSender接口。这个结构体只负责通过SMPT协议发送邮件。</p><p>最后，新的EmailService包含上面的两个接口，委托发送邮件和持久化数据。
可能会出现一个问题：EmailService仍然有多种职责，因为它仍然持有存储和发送邮件的职责？是不是看起来我们只是做了一个抽象，但职责仍然存在？</p><p>在这里，情况并非如此。EmailService并不承担存储和发送邮件的职责。它将其委托给下面的结构。它的职责是将处理邮件的请求委托给底层服务。</p><blockquote><p>持有和委托之间是有区别的。如果对特定代码的改写可以消除职责的全部目的，我们就会谈论持有。如果在删除特定代码后，该职责仍然存在，那么我们就谈及委托。</p></blockquote><p>如果我们删除了完整的EmailService，仍然负责在数据库中存储数据并通过SMTP发送邮件。这意味着我们可以肯定地说，EmailService并没有持有这两项职责。</p><h3 id=其他实践>其他实践</h3><p>正如我们之前可以看到的，SRP适用于多种不同的实现方式，而不仅仅是结构体。可以看到，我们可以打破它对函数的影响，但这个例子已经在结构内打破了SRP的影子。</p><p>为了更好地理解SRP原则在函数中的应用，让我们看看下面这个例子。</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-Go data-lang=Go><span style=color:#f92672>import</span> <span style=color:#e6db74>&#34;github.com/dgrijalva/jwt-go&#34;</span>

<span style=color:#66d9ef>func</span> <span style=color:#a6e22e>extractUsername</span>(<span style=color:#a6e22e>header</span> <span style=color:#a6e22e>http</span>.<span style=color:#a6e22e>Header</span>) <span style=color:#66d9ef>string</span> {
	<span style=color:#a6e22e>raw</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>header</span>.<span style=color:#a6e22e>Get</span>(<span style=color:#e6db74>&#34;Authorization&#34;</span>)
	<span style=color:#a6e22e>parser</span> <span style=color:#f92672>:=</span> <span style=color:#f92672>&amp;</span><span style=color:#a6e22e>jwt</span>.<span style=color:#a6e22e>Parser</span>{}
	<span style=color:#a6e22e>token</span>, <span style=color:#a6e22e>_</span>, <span style=color:#a6e22e>err</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>parser</span>.<span style=color:#a6e22e>ParseUnverified</span>(<span style=color:#a6e22e>raw</span>, <span style=color:#a6e22e>jwt</span>.<span style=color:#a6e22e>MapClaims</span>{})
	<span style=color:#66d9ef>if</span> <span style=color:#a6e22e>err</span> <span style=color:#f92672>!=</span> <span style=color:#66d9ef>nil</span> {
		<span style=color:#66d9ef>return</span> <span style=color:#e6db74>&#34;&#34;</span>
	}

	<span style=color:#a6e22e>claims</span>, <span style=color:#a6e22e>ok</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>token</span>.<span style=color:#a6e22e>Claims</span>.(<span style=color:#a6e22e>jwt</span>.<span style=color:#a6e22e>MapClaims</span>)
	<span style=color:#66d9ef>if</span> !<span style=color:#a6e22e>ok</span> {
		<span style=color:#66d9ef>return</span> <span style=color:#e6db74>&#34;&#34;</span>
	}

	<span style=color:#66d9ef>return</span> <span style=color:#a6e22e>claims</span>[<span style=color:#e6db74>&#34;username&#34;</span>].(<span style=color:#66d9ef>string</span>)
}
</code></pre></div><p>函数extractUsername很短。它提供了对从HTTP头中提取原始JWT令牌的支持<code>和</code>如果里面包含用户名，则返回。</p><p>再一次，你可能注意到粗体字 <code>和</code>。这个方法有多重职责。如何描述并不重要。我们不能避免使用"和"字来描述该函数的作用。</p><p>与其重新描述函数的职责，我们不如重构函数本身。如下：</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-Go data-lang=Go><span style=color:#66d9ef>func</span> <span style=color:#a6e22e>extractUsername</span>(<span style=color:#a6e22e>header</span> <span style=color:#a6e22e>http</span>.<span style=color:#a6e22e>Header</span>) <span style=color:#66d9ef>string</span> {
	<span style=color:#a6e22e>raw</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>extractRawToken</span>(<span style=color:#a6e22e>header</span>)
	<span style=color:#a6e22e>claims</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>extractClaims</span>(<span style=color:#a6e22e>raw</span>)
	<span style=color:#66d9ef>if</span> <span style=color:#a6e22e>claims</span> <span style=color:#f92672>==</span> <span style=color:#66d9ef>nil</span> {
		<span style=color:#66d9ef>return</span> <span style=color:#e6db74>&#34;&#34;</span>
	}
	
	<span style=color:#66d9ef>return</span> <span style=color:#a6e22e>claims</span>[<span style=color:#e6db74>&#34;username&#34;</span>].(<span style=color:#66d9ef>string</span>)
}

<span style=color:#66d9ef>func</span> <span style=color:#a6e22e>extractRawToken</span>(<span style=color:#a6e22e>header</span> <span style=color:#a6e22e>http</span>.<span style=color:#a6e22e>Header</span>) <span style=color:#66d9ef>string</span> {
	<span style=color:#66d9ef>return</span> <span style=color:#a6e22e>header</span>.<span style=color:#a6e22e>Get</span>(<span style=color:#e6db74>&#34;Authorization&#34;</span>)
}

<span style=color:#66d9ef>func</span> <span style=color:#a6e22e>extractClaims</span>(<span style=color:#a6e22e>raw</span> <span style=color:#66d9ef>string</span>) <span style=color:#a6e22e>jwt</span>.<span style=color:#a6e22e>MapClaims</span> {
	<span style=color:#a6e22e>parser</span> <span style=color:#f92672>:=</span> <span style=color:#f92672>&amp;</span><span style=color:#a6e22e>jwt</span>.<span style=color:#a6e22e>Parser</span>{}
	<span style=color:#a6e22e>token</span>, <span style=color:#a6e22e>_</span>, <span style=color:#a6e22e>err</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>parser</span>.<span style=color:#a6e22e>ParseUnverified</span>(<span style=color:#a6e22e>raw</span>, <span style=color:#a6e22e>jwt</span>.<span style=color:#a6e22e>MapClaims</span>{})
	<span style=color:#66d9ef>if</span> <span style=color:#a6e22e>err</span> <span style=color:#f92672>!=</span> <span style=color:#66d9ef>nil</span> {
		<span style=color:#66d9ef>return</span> <span style=color:#66d9ef>nil</span>
	}

	<span style=color:#a6e22e>claims</span>, <span style=color:#a6e22e>ok</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>token</span>.<span style=color:#a6e22e>Claims</span>.(<span style=color:#a6e22e>jwt</span>.<span style=color:#a6e22e>MapClaims</span>)
	<span style=color:#66d9ef>if</span> !<span style=color:#a6e22e>ok</span> {
		<span style=color:#66d9ef>return</span> <span style=color:#66d9ef>nil</span>
	}
	
	<span style=color:#66d9ef>return</span> <span style=color:#a6e22e>claims</span>
}
</code></pre></div><p>如上我们新增了两个新的函数。第一个extractRawToken，职责是从HTTP头中提取原始JWT令牌。如果我们改变了头中持有令牌的一个键，我们应该只碰一个方法。</p><p>第二个是extractClaims。这个方法负责从一个原始的JWT令牌中提取Claims。最后，我们的旧函数extractUsername在将提取令牌的请求委托给底层方法后，从claim中获取特定的值。</p><p>还有更多的例子。其中许多是我们日常经常使用的。一些原因是一些框架使用了错误的方法，还有就是我们懒得提供正确的实现。</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-Go data-lang=Go><span style=color:#66d9ef>type</span> <span style=color:#a6e22e>User</span> <span style=color:#66d9ef>struct</span> {
	<span style=color:#a6e22e>db</span> <span style=color:#f92672>*</span><span style=color:#a6e22e>gorm</span>.<span style=color:#a6e22e>DB</span>
	<span style=color:#a6e22e>Username</span> <span style=color:#66d9ef>string</span>
	<span style=color:#a6e22e>Firstname</span> <span style=color:#66d9ef>string</span>
	<span style=color:#a6e22e>Lastname</span> <span style=color:#66d9ef>string</span>
	<span style=color:#a6e22e>Birthday</span> <span style=color:#a6e22e>time</span>.<span style=color:#a6e22e>Time</span>
	<span style=color:#75715e>//
</span><span style=color:#75715e></span>	<span style=color:#75715e>// some more fields
</span><span style=color:#75715e></span>	<span style=color:#75715e>//
</span><span style=color:#75715e></span>}

<span style=color:#66d9ef>func</span> (<span style=color:#a6e22e>u</span> <span style=color:#a6e22e>User</span>) <span style=color:#a6e22e>IsAdult</span>() <span style=color:#66d9ef>bool</span> {
	<span style=color:#66d9ef>return</span> <span style=color:#a6e22e>u</span>.<span style=color:#a6e22e>Birthday</span>.<span style=color:#a6e22e>AddDate</span>(<span style=color:#ae81ff>18</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>).<span style=color:#a6e22e>Before</span>(<span style=color:#a6e22e>time</span>.<span style=color:#a6e22e>Now</span>())
}

<span style=color:#66d9ef>func</span> (<span style=color:#a6e22e>u</span> <span style=color:#f92672>*</span><span style=color:#a6e22e>User</span>) <span style=color:#a6e22e>Save</span>() <span style=color:#66d9ef>error</span> {
	<span style=color:#66d9ef>return</span> <span style=color:#a6e22e>u</span>.<span style=color:#a6e22e>db</span>.<span style=color:#a6e22e>Exec</span>(<span style=color:#e6db74>&#34;INSERT INTO users ...&#34;</span>, <span style=color:#a6e22e>u</span>.<span style=color:#a6e22e>Username</span>, <span style=color:#a6e22e>u</span>.<span style=color:#a6e22e>Firstname</span>, <span style=color:#a6e22e>u</span>.<span style=color:#a6e22e>Lastname</span>, <span style=color:#a6e22e>u</span>.<span style=color:#a6e22e>Birthday</span>).<span style=color:#a6e22e>Error</span>
}
</code></pre></div><p>上面的例子展示了Active Record这一模式的典型实现。在这种情况下，我们还在用户结构中添加了业务逻辑，而不仅仅是将数据存储到数据库中。</p><p>在这里，我们混合了Active Record和领域驱动设计中的Entity模式。为了正确传递代码，我们需要提供单独的结构体：一个用于在数据库中持久化数据，另一个用于发挥实体的作用。下面的例子中也有同样的问题。</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-Go data-lang=Go><span style=color:#66d9ef>type</span> <span style=color:#a6e22e>Wallet</span> <span style=color:#66d9ef>struct</span> {
	<span style=color:#a6e22e>gorm</span>.<span style=color:#a6e22e>Model</span>
	<span style=color:#a6e22e>Amount</span>     <span style=color:#66d9ef>int</span> <span style=color:#e6db74>`gorm:&#34;column:amount&#34;`</span>
	<span style=color:#a6e22e>CurrencyID</span> <span style=color:#66d9ef>int</span> <span style=color:#e6db74>`gorm:&#34;column:currency_id&#34;`</span>
}

<span style=color:#66d9ef>func</span> (<span style=color:#a6e22e>w</span> <span style=color:#f92672>*</span><span style=color:#a6e22e>Wallet</span>) <span style=color:#a6e22e>Withdraw</span>(<span style=color:#a6e22e>amount</span> <span style=color:#66d9ef>int</span>) <span style=color:#66d9ef>error</span> {
	<span style=color:#66d9ef>if</span> <span style=color:#a6e22e>amount</span> &gt; <span style=color:#a6e22e>w</span>.<span style=color:#a6e22e>Amount</span> {
		<span style=color:#66d9ef>return</span> <span style=color:#a6e22e>errors</span>.<span style=color:#a6e22e>New</span>(<span style=color:#e6db74>&#34;there is no enough money in wallet&#34;</span>)
	}
	
	<span style=color:#a6e22e>w</span>.<span style=color:#a6e22e>Amount</span> <span style=color:#f92672>-=</span> <span style=color:#a6e22e>amount</span>

	<span style=color:#66d9ef>return</span> <span style=color:#66d9ef>nil</span>
}
</code></pre></div><p>以上又有两个职责，第二个责任（通过Gorm包对数据库中的表进行映射）没有直接表达为一种算法，而是表达为Go标签。</p><p>即使现在，钱包结构也打破了SRP原则，因为它扮演着多种角色。如果我们改变数据库方案，我们需要调整这个结构体。如果我们改变取款的业务规则，我们也需要调整这个结构体。</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-Go data-lang=Go><span style=color:#66d9ef>type</span> <span style=color:#a6e22e>Transaction</span> <span style=color:#66d9ef>struct</span> {
	<span style=color:#a6e22e>gorm</span>.<span style=color:#a6e22e>Model</span>
	<span style=color:#a6e22e>Amount</span>     <span style=color:#66d9ef>int</span>       <span style=color:#e6db74>`gorm:&#34;column:amount&#34; json:&#34;amount&#34; validate:&#34;required&#34;`</span>
	<span style=color:#a6e22e>CurrencyID</span> <span style=color:#66d9ef>int</span>       <span style=color:#e6db74>`gorm:&#34;column:currency_id&#34; json:&#34;currency_id&#34; validate:&#34;required&#34;`</span>
	<span style=color:#a6e22e>Time</span>       <span style=color:#a6e22e>time</span>.<span style=color:#a6e22e>Time</span> <span style=color:#e6db74>`gorm:&#34;column:time&#34; json:&#34;time&#34; validate:&#34;required&#34;`</span>
}
</code></pre></div><p>上面的代码片段是另一个破坏SRP的例子。而且，在我看来，这是最悲惨的一个例子，我们无法提供一个更小的结构来承担更多的责任。</p><p>通过查看Transaction结构，我们发现它是用来描述与数据库中的表的映射关系，并成为REST API中JSON响应的持有者，由于有验证部分，它也可以成为API请求的JSON主体。一个结构体可以完成一切。</p><p>所有这些例子迟早都需要进行调整。只要我们在代码中保留它们，它们就是隐藏的问题，很快就会开始破坏我们的代码。</p><h2 id=总结>总结</h2><p>单一责任原则是SOLID原则中的第一个原则。它代表了SOLID中的一个字母S。它表示一个代码结构必须只有一个存在的理由。我们把这些理由看作是职责。一个结构体可以持有职责或委托职责。每当一个结构体持有多个职责时，我们应该重构那段代码。</p><p>参考链接：</p><p>1、https://levelup.gitconnected.com/practical-solid-in-golang-single-responsibility-principle-20afb8643483</p><p>2、https://zh.wikipedia.org/wiki/SOLID_(%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E8%AE%BE%E8%AE%A1)</p></article></section><article class="ui segment utterances-comments" data-html2canvas-ignore><script src=https://utteranc.es/client.js repo=lixianwa/comments-for-myblog issue-term=og:title theme=github-light crossorigin=anonymous async></script></article></div></div><footer class="ui basic center aligned segment" style=background-color:initial><p>© 2014 - 2022 Lionel's Blog</p><p>Powered by <a href=https://gohugo.io/ target=_blank>Hugo</a> with theme <a href=https://github.com/g1eny0ung/hugo-theme-dream target=_blank>Dream</a>.</p></footer></div></section><section class=back><div class=dream-max-width><header class="ui basic very padded segment dream-header"><div class="ui small circular image"><img src=/me/avatar.jpeg alt=avatar></div><div class=content><h1 class="ui medium header">归零的小窝<div class="sub header">收集、总结、分享</div></h1><article class="ui horizontal list"><a class=item href=/posts><i class="archive icon" title=归档></i></a><a class=item href=/categories><i class="th list icon" title=所有分类></i></a><a class=item href=/tags><i class="tags icon" title=所有标签></i></a></article><article class=dream-tags><a class="ui label" href=/tags/actor/ title=Actor>Actor</a>
<a class="ui label" href=/tags/archlinux/ title=archlinux>archlinux</a>
<a class="ui label" href=/tags/arthas/ title=arthas>arthas</a>
<a class="ui label" href=/tags/bug/ title=bug>bug</a>
<a class="ui label" href=/tags/c%E8%AF%AD%E8%A8%80/ title=c语言>c语言</a>
<a class="ui label" href=/tags/dapr/ title=Dapr>Dapr</a>
<a class="ui label" href=/tags/debug/ title=debug>debug</a>
<a class="ui label" href=/tags/dlv/ title=dlv>dlv</a>
<a class="ui label" href=/tags/docker/ title=Docker>Docker</a>
<a class="ui label" href=/tags/go/ title=Go>Go</a>
<a class="ui label" href=/tags/grpc/ title=gRPC>gRPC</a>
<a class="ui label" href=/tags/headless-service/ title="Headless service">Headless service</a>
<a class="ui label" href=/tags/hexo/ title=Hexo>Hexo</a>
<a class="ui label" href=/tags/ios/ title=iOS>iOS</a>
<a class="ui label" href=/tags/istio/ title=Istio>Istio</a>
<a class="ui label" href=/tags/java/ title=java>java</a>
<a class="ui label" href=/tags/jekyll/ title=jekyll>jekyll</a>
<a class="ui label" href=/tags/jupyter-notebook/ title="Jupyter notebook">Jupyter notebook</a>
<a class="ui label" href=/tags/kubernetes/ title=Kubernetes>Kubernetes</a>
<a class="ui label" href=/tags/letsencrypt/ title=Letsencrypt>Letsencrypt</a>
<a class="ui label" href=/tags/markdown/ title=markdown>markdown</a>
<a class="ui label" href=/tags/mongodb/ title=mongodb>mongodb</a>
<a class="ui label" href=/tags/nginx/ title=nginx>nginx</a>
<a class="ui label" href=/tags/pandas/ title=Pandas>Pandas</a>
<a class="ui label" href=/tags/reactivecocoa/ title=ReactiveCocoa>ReactiveCocoa</a>
<a class="ui label" href=/tags/redis/ title=redis>redis</a>
<a class="ui label" href=/tags/restful-api/ title="RESTFul API">RESTFul API</a>
<a class="ui label" href=/tags/solid/ title=SOLID>SOLID</a>
<a class="ui label" href=/tags/ssl%E8%AF%81%E4%B9%A6/ title=SSL证书>SSL证书</a>
<a class="ui label" href=/tags/swift/ title=Swift>Swift</a>
<a class="ui label" href=/tags/v2ray/ title=v2ray>v2ray</a>
<a class="ui label" href=/tags/xcode/ title=Xcode>Xcode</a>
<a class="ui label" href=/tags/%E5%86%85%E5%AD%98/ title=内存>内存</a>
<a class="ui label" href=/tags/%E5%8D%9A%E5%AE%A2/ title=博客>博客</a>
<a class="ui label" href=/tags/%E5%B7%A5%E5%85%B7/ title=工具>工具</a>
<a class="ui label" href=/tags/%E5%BC%80%E6%BA%90/ title=开源>开源</a>
<a class="ui label" href=/tags/%E5%BE%AE%E6%9C%8D%E5%8A%A1/ title=微服务>微服务</a>
<a class="ui label" href=/tags/%E6%8F%90%E9%97%AE/ title=提问>提问</a>
<a class="ui label" href=/tags/%E6%95%99%E7%A8%8B/ title=教程>教程</a>
<a class="ui label" href=/tags/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/ title=数据分析>数据分析</a>
<a class="ui label" href=/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/ title=数据库>数据库</a>
<a class="ui label" href=/tags/%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/ title=最佳实践>最佳实践</a>
<a class="ui label" href=/tags/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/ title=“机器学习”>“机器学习”</a>
<a class="ui label" href=/tags/%E6%AD%BB%E6%9C%BA/ title=死机>死机</a>
<a class="ui label" href=/tags/%E6%B3%9B%E5%9E%8B/ title=泛型>泛型</a>
<a class="ui label" href=/tags/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/ title=“深度学习”>“深度学习”</a>
<a class="ui label" href=/tags/%E6%B8%B8%E8%AE%B0/ title=游记>游记</a>
<a class="ui label" href=/tags/%E7%A7%91%E5%AD%A6%E4%B8%8A%E7%BD%91/ title=科学上网>科学上网</a>
<a class="ui label" href=/tags/%E7%AE%97%E5%AD%90/ title=算子>算子</a>
<a class="ui label" href=/tags/%E7%BF%BB%E8%AF%91/ title=翻译>翻译</a>
<a class="ui label" href=/tags/%E8%87%AA%E8%A1%8C%E8%BD%A6/ title=自行车>自行车</a>
<a class="ui label" href=/tags/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/ title=读书笔记>读书笔记</a></article></div></header><div class="ui relaxed grid dream-grid dream-back"><div class="sixteen wide mobile eight wide tablet four wide computer column dream-column"><article class="ui segment markdown-body"><div class="ui medium header">关于</div><p>要么忙着生活，要么赶着去死!</p></article></div><div class="sixteen wide mobile eight wide tablet four wide computer column dream-column"><article class="ui segment"><div class="ui medium header">社交链接</div><nav class="ui secondary menu dream-menu dream-socials"><div class=item><a href=/index.xml><i class="large rss square icon" title=RSS></i></a></div><div class=item><a href=mailto:lixianwa@gmail.com><i class="large mail icon" title=Email></i></a></div></nav></article></div><div class="sixteen wide mobile eight wide tablet four wide computer column dream-column"><article class="ui segment"><a rel=license href=http://creativecommons.org/licenses/by-nc-sa/4.0/><img alt=知识共享许可协议 style=border-width:0 src=https://i.creativecommons.org/l/by-nc-sa/4.0/88x31.png></a><br>本作品采用<a rel=license href=http://creativecommons.org/licenses/by-nc-sa/4.0/>知识共享署名-非商业性使用-相同方式共享 4.0 国际许可协议</a>进行许可。</article></div></div></div></section></div></div><script>window.defaultDark=null,window.backgroundDark="black",window.backgroundImageDark=null,window.darkNav=null,window.hasTwitterEmbed=null,window.hasTwitterEmbed&&(window.twttr=function(c,d,e){var b,f=c.getElementsByTagName(d)[0],a=window.twttr||{};return c.getElementById(e)?a:(b=c.createElement(d),b.id=e,b.src='https://platform.twitter.com/widgets.js',f.parentNode.insertBefore(b,f),a._e=[],a.ready=function(b){a._e.push(b)},a)}(document,'script','twitter-wjs'))</script><script src=/js/jquery.min.js></script><script src=/js/semantic.min.js></script><script src=/js/jquery.overlayScrollbars.min.js></script><script src=/js/header.js></script><script src=/js/main.js></script><script src=/js/theme.js></script><script src=/js/html2canvas.min.js></script><script src=/js/post.js></script><script src=https://cdn.jsdelivr.net/gh/highlightjs/cdn-release/build/highlight.min.js></script><script src=https://cdn.jsdelivr.net/gh/highlightjs/cdn-release/build/languages/ocaml.min.js></script><script>hljs.initHighlightingOnLoad(),setHighlightTheme();function setHighlightTheme(){var a=localStore.getItem('hugo-theme-dream-is-dark'),b,c,d;a=a?a:window.defaultDark?'y':a,b="gruvbox-light",c="gruvbox-dark",d=a==='y'?c:b,$('link[data-highlight]').attr('href','https://cdn.jsdelivr.net/gh/highlightjs/cdn-release/build/styles/'+d+'.min.css'),$('pre').css('background',a==='y'?'#333':'')}</script><div class="ui inverted segment" id=dream-search><div class="ui search"><div class="ui transparent input"><input class=prompt type=text placeholder=搜索></div><div class=results></div></div></div><script>$(document).ready(function(){$.getJSON('https://lixianwa.github.io//index.json',function(a){$('.ui.search').search({source:a,searchFields:['title'],showNoResults:!0})})})</script><script src=/js/search.js></script><script type=application/javascript>var doNotTrack=!1;doNotTrack||(window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga('create','172168556','auto'),ga('send','pageview'))</script><script async src=https://www.google-analytics.com/analytics.js></script></body></html>